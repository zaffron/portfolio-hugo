{{ with resources.Get "css/main.css" }}
  {{ $opts := dict "minify" (not hugo.IsDevelopment) }}
  {{ with . | css.TailwindCSS $opts }}
    {{ if hugo.IsDevelopment }}
      <link rel="stylesheet" href="{{ .RelPermalink }}" />
    {{ else }}
      {{/* Generate fingerprinted version for main site */}}
      {{ with . | fingerprint }}
        <!-- Preload CSS for faster initial render -->
        <link
          rel="preload"
          as="style"
          href="{{ .RelPermalink }}"
          integrity="{{ .Data.Integrity }}"
          crossorigin="anonymous"
        />
        <link
          rel="stylesheet"
          href="{{ .RelPermalink }}"
          integrity="{{ .Data.Integrity }}"
          crossorigin="anonymous"
        />
      {{ end }}
      {{/* Also generate non-fingerprinted version for CMS admin preview */}}
      {{ $nonFingerprinted := . | resources.Copy "css/main.css" }}
    {{ end }}
  {{ end }}
{{ end }}
